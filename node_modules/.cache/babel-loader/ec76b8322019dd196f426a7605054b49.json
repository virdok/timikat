{"ast":null,"code":"import jwtDecode from \"jwt-decode\";\nimport { verify, sign } from \"jsonwebtoken\";\nimport axios from \"./axios\";\n\nvar isValidToken = function isValidToken(accessToken) {\n  if (!accessToken) {\n    return false;\n  }\n\n  var decoded = jwtDecode(accessToken);\n  var currentTime = Date.now() / 1000;\n  return decoded.exp > currentTime;\n}; //  const handleTokenExpired = (exp) => {\n//   let expiredTimer;\n//   window.clearTimeout(expiredTimer);\n//   const currentTime = Date.now();\n//   const timeLeft = exp * 1000 - currentTime;\n//   console.log(timeLeft);\n//   expiredTimer = window.setTimeout(() => {\n//     console.log('expired');\n//   }, timeLeft);\n// };\n\n\nvar setSession = function setSession(accessToken) {\n  if (accessToken) {\n    localStorage.setItem(\"accessToken\", accessToken);\n    axios.defaults.headers.common.Authorization = \"Bearer \".concat(accessToken); // This function below will handle when token is expired\n    // const { exp } = jwtDecode(accessToken);\n    // handleTokenExpired(exp);\n  } else {\n    localStorage.removeItem(\"accessToken\");\n    delete axios.defaults.headers.common.Authorization;\n  }\n};\n\nexport { verify, sign, isValidToken, setSession };","map":{"version":3,"sources":["/home/dkirchan/timikat2/timikat/src/utils/jwt.js"],"names":["jwtDecode","verify","sign","axios","isValidToken","accessToken","decoded","currentTime","Date","now","exp","setSession","localStorage","setItem","defaults","headers","common","Authorization","removeItem"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,YAAtB;AACA,SAASC,MAAT,EAAiBC,IAAjB,QAA6B,cAA7B;AACA,OAAOC,KAAP,MAAkB,SAAlB;;AAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,WAAD,EAAiB;AACpC,MAAI,CAACA,WAAL,EAAkB;AAChB,WAAO,KAAP;AACD;;AACD,MAAMC,OAAO,GAAGN,SAAS,CAACK,WAAD,CAAzB;AACA,MAAME,WAAW,GAAGC,IAAI,CAACC,GAAL,KAAa,IAAjC;AAEA,SAAOH,OAAO,CAACI,GAAR,GAAcH,WAArB;AACD,CARD,C,CAUA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,IAAMI,UAAU,GAAG,SAAbA,UAAa,CAACN,WAAD,EAAiB;AAClC,MAAIA,WAAJ,EAAiB;AACfO,IAAAA,YAAY,CAACC,OAAb,CAAqB,aAArB,EAAoCR,WAApC;AACAF,IAAAA,KAAK,CAACW,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8BC,aAA9B,oBAAwDZ,WAAxD,EAFe,CAGf;AACA;AACA;AACD,GAND,MAMO;AACLO,IAAAA,YAAY,CAACM,UAAb,CAAwB,aAAxB;AACA,WAAOf,KAAK,CAACW,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8BC,aAArC;AACD;AACF,CAXD;;AAaA,SAAShB,MAAT,EAAiBC,IAAjB,EAAuBE,YAAvB,EAAqCO,UAArC","sourcesContent":["import jwtDecode from \"jwt-decode\";\r\nimport { verify, sign } from \"jsonwebtoken\";\r\nimport axios from \"./axios\";\r\n\r\nconst isValidToken = (accessToken) => {\r\n  if (!accessToken) {\r\n    return false;\r\n  }\r\n  const decoded = jwtDecode(accessToken);\r\n  const currentTime = Date.now() / 1000;\r\n\r\n  return decoded.exp > currentTime;\r\n};\r\n\r\n//  const handleTokenExpired = (exp) => {\r\n//   let expiredTimer;\r\n\r\n//   window.clearTimeout(expiredTimer);\r\n//   const currentTime = Date.now();\r\n//   const timeLeft = exp * 1000 - currentTime;\r\n//   console.log(timeLeft);\r\n//   expiredTimer = window.setTimeout(() => {\r\n//     console.log('expired');\r\n//   }, timeLeft);\r\n// };\r\n\r\nconst setSession = (accessToken) => {\r\n  if (accessToken) {\r\n    localStorage.setItem(\"accessToken\", accessToken);\r\n    axios.defaults.headers.common.Authorization = `Bearer ${accessToken}`;\r\n    // This function below will handle when token is expired\r\n    // const { exp } = jwtDecode(accessToken);\r\n    // handleTokenExpired(exp);\r\n  } else {\r\n    localStorage.removeItem(\"accessToken\");\r\n    delete axios.defaults.headers.common.Authorization;\r\n  }\r\n};\r\n\r\nexport { verify, sign, isValidToken, setSession };\r\n"]},"metadata":{},"sourceType":"module"}